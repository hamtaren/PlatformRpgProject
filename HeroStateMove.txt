///scr_HeroStateMove()
//TODO: pomysl: ujednolicic dla prawo/lewo wszystkie skrypty,
//TODO: zmienic keyboard_check_sides na input_check_sides (dla joy i klawki)

//wykrywanie podloza/grawitacja/tarcie
if (!place_meeting_solid(x,y+vspd+1))
{
    grav = 0.5;
    vspd+=grav;  
    friction=0;
}
else
{
    grav = 0;
    friction = moveFriction;
}

//Skakanie
if (keyboard_check_pressed(KEY_UP))
{
    if (grav==0 && vspd==0) //im szybciej biegnie tym wyzej skacze
        vspd = jumpPower + (1 - (abs(hspd) / moveSpeed))*3        
}

//Wcisniecie i trzymanie przycisku na boki
if (keyboard_check_sides())
{
	//Jezeli jest na ziemi
	if (grav==0)
	{
		//Chodzenie na boki na plaskim
		if (!place_meeting_solid(x+hspd+moveAcc*keySide),y)
		{
			var multi = 1;
			if (sign(hspd)!=keySides) //szybsze wyhamowanie jezeli biegnie wciskamy przycisk w przeciwnym kierunku do aktualnego kierunku poruszania sie
				multi = 5;
				
			hspd +=multi*moveAcc*keySide;
		}
		else if (place_meeting_diagonal(x+hspd+(moveAcc*keySides), y) && !place_meeting_diagonal(x-(4*keySides),y) ) //wchodzenie po krzywym
		{
			for (var i = 0; i<8; i++)			
				if (!place_meeting_diagonal(x+hspd+(moveAcc*keySides),y-i))
				{
					y-=i;
					hspd = max(abs(hspd)+moveAcc, 1)*keySides;
					break;
				}			
		}
		//TODO: gladkie schodzenie (masz prawdopodobnie w projektach w gm8)
	}
}

//Slizganie sie przy scianie podczas spadania
if ( (place_meeting(x+5,y,obj_SlideableSolid) || place_meeting(x-5,y,obj_SlideableSolid)) && grav!=0 && hspd==0)
    slide = true;
else
    slide = false;
	
//Wcisniecie przysku na boki
if (keyboard_check_pressed_sides())
{
	//Odbijanie sie od scian podczas slizgania
	if (slide)
	{
		hspd=5*keySide;
		vspd=-3;
	}
}

//Zaden przycisk na boki nie jest wciskany
if (!keyboard_check_sides())
{
	//Zatrzymywanie
    if ( abs(hspd!=0))
        hspd =max (abs(hspd) - friction ,0) * sign(hspd); 
}

//Graniczenie predkosci spadania i rozpedu
vspd = clamp(vspd, -10, 10); 
hspd = clamp(hspd, -moveSpeed, moveSpeed);

//Poziome wykrywanie zblizajacych sie solidow
if (place_meeting_solid(x+hspd, y))
{
    while(!place_meeting_solid(x+sign(hspd), y))
        x += sign(hspd);
    hspd=0;
}

//przemieszczenie w poziomie
    x+=hspd;
 
//Pionowe wykrywanie zblizajacych sie solidow   
if (place_meeting_solid(x, y +vspd))
{
    while(!place_meeting_solid(x, y +sign(vspd)))
        y+= sign(vspd);
    vspd = 0;
}

//przemieszczenie w pionie
    y+=vspd;
