<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_TrollStand</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>obj_Boss</parentName>
  <maskName>spr_TrollMask</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited();

expirience = 1500;

state = STATE_NONE;

hpMax = 250;
hp = 250;

staminaMax = 100;
stamina = staminaMax;
staminaReg = 0.25;

mvSpeed = 2;

sprite_stand = spr_TrollStand;
sprite_jump = spr_TrollJumpAttack;
sprite_attack = spr_TrollClubAttack;
sprite_move = spr_TrollWalk;

towards = false;
created = false;

encounter = false;
slamDmg = instance_create(0,32,obj_DR);

scr_DRSet(resObject,1,0.8,0.8,5,1,1,1);
scr_DRSet(dmgObject,0,0,10,0,0,0,2);
scr_DRSet(slamDmg,0,0,15,0,0,0,5);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var xx = irandom_range(3408,3712);
var yy = irandom_range(192,224);
var spawn = choose(obj_UnarmedGoblinDagger, obj_UnarmedGoblinMaczuga, obj_UnarmedGoblinAxe, obj_UnarmedGoblin);
instance_create(xx,yy,spawn);

alarm[0] = 15*room_speed;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///BEHAVIOR
event_inherited();

scr_EnemyGravity();

    if (!encounter)
    {
        if (!collision_line(x,y-8,obj_Hero.x,obj_Hero.y-8,obj_Solid,1,1))
        {
            if (distance_to_object(obj_Hero)&lt;300)
            {
                encounter = true;
                sound_stop_all();
                sound_loop(m_Boss);        
                event_user(1);
            }
        }
    }
    else
    {
        stamina += staminaReg;
        stamina = clamp(stamina,0,staminaMax);
        
        if (state != STATE_CLIMB &amp;&amp; state != STATE_SHOOT)   //STOI ALBO IDZIE
        {
            if (stamina &lt; 20)
            {
                state = STATE_NONE;
            }
            else
            {
                if (distance_to_point(obj_Hero.x,y)&gt;25) //jezeli bohater jest troche dalej to go gon! To go kurde gon!
                {
                    state = STATE_MOVE;
                    hspd = mvSpeed*image_xscale;
                }
                else    //jezeli bohater jest blisko
                {
                    if (!obj_Hero.dead)
                    {
                        if (distance_to_object(obj_Hero) &gt;= 15 &amp;&amp; distance_to_object(obj_Hero) &lt;=25)
                        {
                            hspd = 0;
                            state = STATE_SHOOT;
                            image_index = 0; 
                            stamina -= 10;           
                            sound_play(choose(s_TrollAttack1,s_TrollAttack2));
                        }
                        else if (distance_to_object(obj_Hero) &lt;15 || place_meeting(x,y,obj_Hero))
                        {
                            state = STATE_CLIMB;
                            vspd = -10;
                            hspd = 0;
                            stamina -= 30;
                            sound_play(choose(s_TrollAttack1,s_TrollAttack2));                
                        }  
                    } 
                }
            }
        }
        else if (state == STATE_CLIMB)  //WYSKOK I SPADEK
        {
            if (vspd&gt;=0 &amp;&amp; !towards)
            {
                towards = true;
                move_towards_point(obj_Hero.x,obj_Hero.y,10);
            }
            if (towards &amp;&amp; place_meeting_solid(x,y))
            {
                towards = false;
                speed = 0;
                vspd = 0;
                state = STATE_NONE;
                
                //Wychodzenie z ziemi
                for (var i = 0; i&lt;20; i++)
                {
                    if (!place_meeting_solid(x,y-i))
                    {
                        y-=i;
                        break;
                    }
                }
                slam = instance_create(x,y,obj_DamageSlam);        
                slam.dmg = slamDmg;
                instance_create(x,y,obj_SlamEffect);
            }        
        }
        else if (state == STATE_SHOOT)  //ATAK REKA
        {
            if (round(image_index) &gt; 1 &amp;&amp; created == false)
            {
                if (object_get_name(id.object_index)=="obj_Crimson")
                    hspd = image_xscale;
                created = true;
                scr_ActorCreateDamage(18,12,obj_DamageSlash);
            }
        
            if (round(image_index) &gt; 2)
            {
                hspd = 0;
                created = false;
                state = STATE_NONE;
            }
        }
    
    }

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="16">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>sound_play(choose(s_TrollHit1,s_TrollHit2));
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="11">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>alarm[0] = 20*room_speed;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="10">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>scr_TreasureClassVariablesSet(choose(3,4,4,4,5,5),0,0,1,1,1,0,-0.05);
sound_stop(m_Boss);
scr_ParticlesBloodCreate(40);

    with(obj_Trigger)
    {
        if (5 == trigId)
        {
            trigger = true;
            sound_play(s_TrollDead);
        }
    }
    
instance_destroy();
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
